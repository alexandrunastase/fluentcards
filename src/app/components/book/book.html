<div class="book">
  <div class="navbar navbar-light navbar-full book__nav">
    <div class="container">
      <nav class="nav nav-inline">
        <span class="navbar-brand"><img src="./logo.svg" alt="▯▯▯" height="16" /></span>
        <a class="nav-link" [routerLink]="[ '/' ]">Back to the list</a>
        <a class="nav-link pull-right" href="https://github.com/katspaugh/kindle-flashcards-browser/issues">Having an issue?</a>
      </nav>
    </div>
  </div>

  <div class="book__header container">
    <img *ngIf="book.cover" [src]="book.cover"
         class="book__cover pull-left"
         alt="{{ book.title }} cover" />

    <h4 class="book__title">
      {{ book.title }}<br />
      <small>by <em>{{ book.authors }}</em></small>
    </h4>
  </div>

  <div class="container-fluid">
    <div class="book__controls row">
      <div class="pull-left">
        <label>Choose your native language:&nbsp;
          <select class="c-select" [(ngModel)]="language" (ngModelChange)="onLanguageSelect($event)">
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="fr">Français</option>
            <option value="de">Deutsch</option>
            <option value="ru">Русский</option>
          </select>

          &nbsp;to&nbsp;
        </label>

        <button class="btn btn-primary-outline" (click)="addTranslations()" [disabled]="isTranslationLoading">
          <loader [isLoading]="isTranslationLoading"></loader> add translations
          <span [hidden]="!isTranslationLoading">&nbsp;({{ translationProgress }}%)</span>
        </button>
      </div>

      <div class="pull-left book__button">
        <label>Optionally,&nbsp;
          <button class="btn btn-primary-outline" (click)="addCloze()" [disabled]="book.vocabs[0].cloze != null">
            add cloze test
          </button>
        </label>

        <span class="text-muted">
          &nbsp;(<a class="text-muted" href="http://ankisrs.net/docs/manual.html#cloze-deletion">What is a <u>cloze test</u>?</a>)
        </span>
      </div>

      <div class="pull-right book__button">
        <button class="btn btn-success-outline" (click)="exportCsv()">
          Export as CSV
        </button>
      </div>
    </div>

    <div class="container">
      <div class="alert alert-danger" role="alert" [hidden]="!errorMessage">{{ errorMessage }}</div>
    </div>

    <table class="book__table table table-striped">
      <thead>
        <th>#</th>
        <th>Word</th>
        <th *ngIf="isTranslationLoading || book.vocabs[0].translation != null">Translation</th>
        <th>Sentence</th>
        <th *ngIf="book.vocabs[0].cloze != null">Cloze</th>
      </thead>

      <tbody>
        <tr *ngFor="let vocab of book.vocabs; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ vocab[0] }}</td>
          <td *ngIf="isTranslationLoading || book.vocabs[0].translation != null">
            <span [hidden]="!vocab.translation">{{ vocab.translation }}</span>
            <center [hidden]="vocab.translation"><loader [isLoading]="isTranslationLoading"></loader></center>
          </td>
          <td>{{ vocab[2] }}</td>
          <td *ngIf="vocab.cloze != null">{{ vocab.cloze }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <footer class="navbar navbar-light navbar-full book__nav book__footer">
    <div class="container">
      <nav class="nav nav-inline">
        <span class="nav-link">© 2016 <a href="https://github.com/katspaugh">katspaugh</a></span>
        <span class="nav-link">UI design by <a href="https://dribbble.com/romasketch">Roma</a></span>
        <a class="nav-link" href="https://github.com/katspaugh/kindle-flashcards-browser/issues">Source code on GitHub</a>

        <span class="nav-link pull-right">Powered by Yandex.Translate</span>
      </nav>
    </div>
  </footer>
</div>
